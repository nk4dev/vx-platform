# GitHub Copilot 利用仕様書

English version is available at `.github/copilot-spec.en.md`.

この文書は本リポジトリにおける GitHub Copilot（補助AI）の利用ルールと推奨プロンプトを定めた仕様書です。開発効率を高めつつ、品質・セキュリティ・ライセンス遵守を確保することが目的です。

## 目的

- Copilot をチームの補助ツールとして安全かつ効果的に利用する。
- 生成コードの品質基準、審査フロー、禁止事項を明確にする。
- リポジトリ固有のコーディング規約やファイル配置（例: TypeScript、Next.js、`src/layout/main.tsx`など）に合わせた利用法を提示する。

## 適用範囲

- 本リポジトリ内での開発作業（コード作成、リファクタ、テスト生成、ドキュメント草案など）。
- 自動生成物は必ず人がレビューすること（Pull Request を必須とする）。

## 基本ルール

1. 生成コードは"提案"に過ぎない。必ず人がレビューし、セキュリティ・型・テストを確認してからマージする。
2. 秘密情報（APIキー、パスワード、接続文字列、個人情報など）は絶対に生成させない／コミットしない。
3. ライセンスに注意：外部コードのフラグメントを生成した場合、それが第三者の著作物に依存していないかを確認する。
4. テストを自動生成する場合は、期待値・境界条件・負荷ケースを明示して生成させ、生成後にテストを実行して確認する。
5. 生成物の責任は依頼した開発者にある。レビュー者は最低限の動作検証（ビルド、型チェック、主要ユニットテスト）を行う。

## リポジトリ固有の注意点

- 言語: TypeScript / React / Next.js。`src/pages` と `src/layout` の構成を尊重する。
- コンポーネント: 関数コンポーネント（FC）を基本とする。`main.tsx` レイアウトを壊さないよう注意する。
- 型安全: any の使用は最小限にし、必要な場合はコメントで理由を明記する。
- ビルドチェック: 生成コードを追加したら、`tsc`（型チェック）を通すこと。

## 推奨プロンプト（テンプレート）

以下は本リポジトリで使いやすいプロンプト例です。プロンプトは具体的に、期待する入出力・制約を明確に書いてください。

- 新しい React コンポーネントを作る（例）

```
# コンテキスト
- このリポジトリは TypeScript と Next.js を使用しています。
- レイアウトは `src/layout/main.tsx` にあります。

# 要求
1. `src/components/` に `MyButton.tsx` というシンプルなボタンコンポーネントを作成してください。
2. props: `label: string`, `onClick?: () => void`, `disabled?: boolean`。
3. TypeScript の型注釈を付けること。
4. テールウィンドやスタイルフレームワークに依存しないプレーンなクラス名だけを使うこと。
5. 付属する簡単なユニットテスト（Jest / React Testing Library）を1つ追加する。

# 出力形式
- ファイル名と中身を分けて返すこと。```

- 既存の関数をリファクタリングする（例）

```
# コンテキスト
- `src/pages/index.tsx` に長いコンポーネントがあります。

# 要求
1. 提案するリファクタ案を3つ示してください（簡潔に）。
2. 最良案のコードスニペットを TypeScript で示す（実行可能なレベル）。
3. 既存の機能を壊さないように、動作の前後での簡単なテスト手順を示す。
```

### Next.js + Tailwind 用プロンプトテンプレート

Next.js と Tailwind を組み合わせたコンポーネントやページを生成する場合の推奨テンプレートです。Tailwind のユーティリティクラスを用いてレスポンシブ・アクセシビリティを意識したコードを生成させるため、クラス名やレスポンシブの要件、テスト、ビルド確認を明示してください。

- コンポーネント（Tailwind を使う）

```
# コンテキスト
- プロジェクト: Next.js + TypeScript
- スタイル: Tailwind CSS（`globals.css` に `@tailwind base; @tailwind components; @tailwind utilities;` がある想定）

# 要求
1. `src/components/PrimaryButton.tsx` を作成してください。
2. props: `children: React.ReactNode`, `onClick?: () => void`, `disabled?: boolean`, `className?: string`。
3. Tailwind のユーティリティクラスで見た目を実装（例: `px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white`）。
4. アクセシビリティ: `aria-disabled` を適切に設定し、`button` 要素を使用すること。
5. 付随して `src/components/__tests__/PrimaryButton.test.tsx`（React Testing Library / Jest）でクリック時の挙動と disabled 時の snapshot を1つずつ追加する。

# 出力形式
- ファイルパスと中身を分けて返してください。テストは `describe` / `it` を使った簡潔なものにしてください。
```

- ページ / レイアウトの更新（Tailwind utilities を使う）

```
# コンテキスト
- `src/pages/index.tsx` に Hero セクションを追加したい。
- レイアウトは `src/layout/main.tsx` がある。

# 要求
1. 既存の `index.tsx` に Tailwind を使った Hero セクション（見出し + サブテキスト + PrimaryButton）を追加する差分パッチを示してください。
2. モバイル（sm）/デスクトップ（lg）でのレイアウト切り替えを含めること（例: `flex-col lg:flex-row`）。
3. 変更後に動作確認する手順（`npm run dev`、ブラウザでの確認、`npm run build`）を箇条書きで示すこと。

# 出力形式
- パッチ形式で（変更ファイル名と変更点）と、追加した JSX のフルスニペットを返すこと。
```

- Tailwind 設定の追加や調整

```
# コンテキスト
- Tailwind のカスタムカラーやフォントを追加したい。

# 要求
1. `tailwind.config.js` にカスタムカラー `brand-blue: '#0ea5e9'` を追加する変更例を示してください。
2. 変更後に `npm run build` と `npm run lint` を実行して問題ないか確認するコマンドを提示すること。

# 出力形式
- `tailwind.config.js` の差分と、global CSS (もし必要なら `globals.css`) の変更点を返す。
```

注意点:
- Tailwind クラスは冗長になりがちなので、ユーティリティのグループ（例: `const baseBtn = "px-4 py-2 rounded-md";` のような）を導入するか、共通クラス名にまとめる提案を促すプロンプトにすること。
- 生成コードが `any` を使わないよう明確に指示してください。

- テストを作る（例）

```
# コンテキスト
- ある関数 `formatCurrency` が `src/utils/format.ts` にあります。

# 要求
1. `formatCurrency` の正常系と異常系のユニットテストを作ってください（Jest）。
2. 入力例と期待出力を3つ以上示す。
```

## サンプルコミットメッセージ生成テンプレート

```
# 要求
- 変更点の要約を50文字以内で出力。
- 詳細説明を1段落（2〜3行）で出力。
- 変更ファイル一覧を箇条書きで出力。
```

## セキュリティ & 禁止事項

- Copilot に対して以下を生成させないこと:
  - 秘密情報（API キー、証明書、パスワード）
  - 個人情報（名前、メールアドレス、電話番号など実在の個人情報）
  - 許可のないサードパーティコード（商用ライセンスの制約があるもの）
- 生成されたコードは必ず静的解析（ESLint / TypeScript）、およびユニットテストで検証する。

## PR レビュー時のチェックリスト

- [ ] ビルドが通る（`npm run build` または `tsc`）
- [ ] 型エラーがない
- [ ] セキュリティ上の懸念（シークレット、ハードコーディングされた認証情報）がない
- [ ] サードパーティ資産やライセンスの問題がない
- [ ] 単体テストが追加された場合は、テストが通る
- [ ] 生成コードに適切なコメント／理由が付与されている（必要時）

## メンテナンス

- このファイルはチームで随時更新すること。変更は Pull Request で提案し、少なくとも1人のレビュー承認を得ること。
- 重要な変更（セキュリティ方針の変更など）はチーム全体に通知する。

## 問い合わせ先

- リポジトリ管理者 / 保守担当（README や CODEOWNERS に記載の担当者）へ連絡してください。

---

この仕様は簡潔に保ちつつ、実運用での安全性と品質を守ることを目標としています。必要であれば、プロンプト例やチェックリストを拡張します。